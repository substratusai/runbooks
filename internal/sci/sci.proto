syntax = "proto3";

package sci.v1;
import "google/protobuf/struct.proto";
option go_package = "github.com/substratusai/substratus/internal/sci";

service Controller {
  rpc CreateSignedURL(CreateSignedURLRequest) returns (CreateSignedURLResponse) {}
  rpc GetObjectMd5(GetObjectMd5Request) returns (GetObjectMd5Response) {}
  rpc BindKSAToIAMPrincipal(BindKSAToIAMPrincipalRequest) returns (BindKSAToIAMPrincipalResponse) {} // strictly adds a permission for an IAM principal to a KSA
}

message BindKSAToIAMPrincipalRequest {
  string namespace = 1;
  string kubernetesServiceAccount = 2;
  string iamPrincipal = 3;
  google.protobuf.Struct params = 4;
}

message BindKSAToIAMPrincipalResponse {}

message CreateSignedURLRequest {
  string bucketName = 1;
  string objectName = 2;
  int64 expirationSeconds = 3;
  string md5checksum = 4;
}

message CreateSignedURLResponse {
  string url = 1;
}

message GetObjectMd5Request {
  string bucketName = 1;
  string objectName = 2;
}

message GetObjectMd5Response {
  string md5checksum = 1;
}
